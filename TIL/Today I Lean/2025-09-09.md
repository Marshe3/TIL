## TIL 2025-09-08

### 오늘 배운 것
# gradio를 활용한 모델 interface 구축하기

import gradio as gr

def animal(img):
    # 1. 모델추론
    pre = model.predict(img)
    # 2. 확률 값에서 가장 높은 값 찾기
    class_num = np.argmax(np.array(pre[0].probs.data))

    # 3. 클래스 번호를 클래스명으로 변경
    return pre[0].names[class_num]

demo = gr.Interface(
    fn=animal, # 입력과 출력 사이에 적용될 알고리리즘용 사용자함수
    inputs=["image"], # 입력인터페이스
    outputs=["text"], # 출력인터페이스
)

demo.launch()

# 모델학습
from ultralytics import YOLO

# Load a model

model = YOLO("yolo11n-cls.pt")  # load a pretrained model (recommended for training)


# Train the model
results = model.train(data="./data/face", epochs=50, imgsz=224)

# gradio를 활용한 모델 interface 구축하기

import gradio as gr

def face(img):
    # 1. 모델추론
    pre = model.predict(img)
    # 2. 확률 값에서 가장 높은 값 찾기
    class_num = np.argmax(np.array(pre[0].probs.data))

    # 3. 클래스 번호를 클래스명으로 변경
    return pre[0].names[class_num]

demo = gr.Interface(
    fn=face, # 입력과 출력 사이에 적용될 알고리리즘용 사용자함수
    inputs=["image"], # 입력인터페이스
    outputs=["text"], # 출력인터페이스
)

demo.launch()
