## TIL 2025-08-19

### 오늘 배운 것

- Service 레이어
  -  컨트롤러와 저장소(Repository) 사이에서 비즈니스 로직과 트랜잭션 경계를 담당하는 서버측 구성요소(@Service). MVC의 “V(뷰)·C(컨트롤러)”와는 분리된 계층화 아키텍처의 핵심이다. 


- 전체 요청 흐름 속 역할

  - 요청 흐름(요약): 클라이언트 → DispatcherServlet(프론트 컨트롤러) → 핸들러 매핑/어댑터 → Controller(웹 계층) → Service(도메인 규칙·거래 처리) → Repository(데이터 접근) → ViewResolver/뷰 렌더링. 
  - DispatcherServlet 은 요청을 받아 컨트롤러 호출·예외 처리·뷰 해석 등의 공통 알고리즘을 수행한다(프론트 컨트롤러 패턴). 


- Service 레이어가 하는 일
  - 비즈니스 규칙 구현: 도메인 규칙·검증·여러 저장소/외부 API 조합 등을 캡슐화. 컨트롤러는 HTTP 처리에 집중. 
  - 트랜잭션 경계: @Transactional 로 원자성·격리수준·전파(예: REQUIRED) 등을 선언. 기본 전파는 REQUIRED, 격리는 기본값. 
  - 재사용 가능한 응용 서비스: 같은 로직을 배치/이벤트/다른 컨트롤러에서 재사용 가능. (일반 원칙, 표준 문구 아님—그러나 업계 관행)

- Service를 쓰나?
  - 관심사 분리: 웹(HTTP)과 도메인 로직 분리 → 테스트 용이·유지보수성 향상. 
  - 트랜잭션 관리의 중심: 데이터 일관성 보장 위치로 적합. 
  - 구현 교체 용이: Repository·외부 API가 바뀌어도 서비스 인터페이스로 보호.

- 구현 핵심(스프링 표준)
  - 어노테이션: @Service(스테레오타입, 컴포넌트 스캔 대상) + 필요 시 @Transactional. 
  - 입·출력 모델: 컨트롤러에는 Model/ModelMap/ModelAndView로 뷰에 데이터 전달, 서비스는 순수 자바 객체(Domain/DTO) 를 주고받는 것이 보편적. 
  - 데이터 접근: Spring Data JPA 등 Repository 인터페이스를 주입받아 사용.